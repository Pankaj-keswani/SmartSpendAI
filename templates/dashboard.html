<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SmartSpend Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700;900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
 background:#020617;
 color:white;
 font-family:'Poppins',sans-serif;
}

/* Background */
.bg{
 position:fixed;inset:0;
 background:
 radial-gradient(circle at 25% 25%, rgba(59,130,246,.4), transparent 45%),
 radial-gradient(circle at 75% 30%, rgba(168,85,247,.45), transparent 45%);
 filter:blur(60px);
 z-index:-2;
}

/* Navbar */
nav{
 position:sticky;top:0;
 display:flex;
 justify-content:space-between;
 padding:18px 22px;
 background:rgba(2,6,23,.8);
 backdrop-filter:blur(18px);
 z-index:10;
}

/* Container */
.container{padding:20px}

/* Title */
.title{
 font-size:clamp(22px,5vw,34px);
 font-weight:900;
 margin-bottom:14px;
 background:linear-gradient(90deg,#60a5fa,#a78bfa);
 -webkit-background-clip:text;
 color:transparent;
}

/* Insight */
.insight{
 background:rgba(15,23,42,.9);
 border-radius:16px;
 padding:14px;
 font-size:13px;
 margin-bottom:18px;
 border-left:4px solid #60a5fa;
}

/* Cards */
.cards{
 display:grid;
 grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
 gap:16px;
}
.card{
 background:rgba(15,23,42,.9);
 padding:20px;
 border-radius:18px;
 box-shadow:0 0 40px rgba(99,102,241,.25);
}

/* Filters */
.filters{
 display:flex;
 gap:10px;
 margin:18px 0;
 flex-wrap:wrap;
}
.filter{
 padding:8px 14px;
 border-radius:999px;
 font-size:12px;
 background:#0f172a;
 cursor:pointer;
 border:1px solid rgba(255,255,255,.08);
}
.filter.active{background:#6366f1}

/* Table */
.big-card{
 margin-top:20px;
 background:rgba(15,23,42,.95);
 border-radius:18px;
 padding:16px;
 overflow-x:auto;
}
table{
 width:100%;
 min-width:720px;
 border-collapse:collapse;
}
th,td{padding:12px;font-size:13px}
th{background:#0f1a2f}
tr:nth-child(even){background:#0b1225}

/* Chips */
.chip{
 padding:6px 10px;
 border-radius:10px;
 font-size:12px;
}
.shopping{background:#2563EB}
.food{background:#16A34A}
.transfer{background:#7C3AED}
.bills{background:#DC2626}
.others{background:#6B7280}
</style>
</head>

<body>

<div class="bg"></div>

<nav>
 <div>ðŸ’¸ SmartSpend <span style="color:#60a5fa">AI</span></div>
 <div>Dashboard</div>
</nav>

<div class="container">

<div class="title">Expense Intelligence</div>

<div class="insight">
 ðŸ’¡ You made <b>{{ total_transactions }}</b> transactions with total spend of <b>â‚¹ {{ total_spend }}</b>.
</div>

<div class="cards">
 <div class="card"><b>Total Spend</b><br><span id="spend" style="font-size:26px">0</span></div>
 <div class="card"><b>Total Transactions</b><br><span id="tx" style="font-size:26px">0</span></div>
 <div class="card"><b>Top Category</b><br><span style="font-size:20px">{{ top_category }}</span></div>
</div>

<div class="filters">
 <div class="filter active">All</div>
 <div class="filter">Food</div>
 <div class="filter">Shopping</div>
 <div class="filter">Money Transfer</div>
</div>

<div class="cards">
 <div class="card"><canvas id="pieChart"></canvas></div>
 <div class="card"><canvas id="barChart"></canvas></div>
</div>

<div class="big-card">
<table>
<tr><th>Date</th><th>Description</th><th>Amount</th><th>Category</th></tr>
{% for t in rows %}
<tr>
<td>{{ t['Transaction Date'] }}</td>
<td>{{ t['Description/Narration'] }}</td>
<td>â‚¹ {{ t['Amount'] }}</td>
<td>
<span class="chip
{% if t['AI Category']=="Shopping" %}shopping
{% elif t['AI Category']=="Food" %}food
{% elif t['AI Category']=="Money Transfer" %}transfer
{% elif t['AI Category']=="Bills" %}bills
{% else %}others{% endif %}
">{{ t['AI Category'] }}</span>
</td>
</tr>
{% endfor %}
</table>
</div>

</div>

<script>
function animate(id,val){
 let c=0;
 const el=document.getElementById(id);
 const t=setInterval(()=>{
  c+=Math.ceil(val/40);
  if(c>=val){c=val;clearInterval(t)}
  el.innerText=(id==="spend"?"â‚¹ ":"")+c;
 },30);
}
animate("spend",{{ total_spend|int }});
animate("tx",{{ total_transactions }});

const labels=[{% for c in category_summary %}"{{ c[0] }}",{% endfor %}];
const values=[{% for c in category_summary %}{{ c[1] }},{% endfor %}];

new Chart(pieChart,{
 type:"pie",
 data:{labels,datasets:[{data:values,backgroundColor:["#60a5fa","#a78bfa","#34d399","#fca5a5","#9ca3af"]}]}
});
new Chart(barChart,{
 type:"bar",
 data:{labels,datasets:[{data:values,backgroundColor:"#38BDF8"}]},
 options:{plugins:{legend:{display:false}}}
});
</script>

</body>
</html>